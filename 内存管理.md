## C++内存管理

### C++5种存储区

1. **栈**：存放局部变量，函数参数；由编译器自动分配和释放，分配效率高，内存空间连续，但空间有限

2. **堆**：需要手动分配和释放，属于动态分配。空间大小没有限制，内存空间不连续，存在内存碎片。

3. **全局/静态存储区**：全局变量，静态变量分配到该区，程序结束时自动释放。

4. **文字常量区**：存放常量，不允许修改，程序结束后释放。

5. **程序代码区**：存放程序二进制代码。


### 使用存储区的三种方式

1. 静态存储区：全局变量，静态变量和静态类成员函数存储在该区

2. 自动存储区：局部变量，函数参数存储该区，自动释放。

3. 自由存储区：由程序员手动分配和释放内存。

### 堆与栈的区别

1. 空间大小：栈空间连续，大小确定；堆空间不连续，内存空间几乎没有限制，32位下，达4G。

2. 管理方式：栈由编译器自动分配和释放；堆需要手动分配和释放。

3. 生长方式：栈向着内存地址减小的方向生长，这也是为什么栈内存空间有限的原因；堆向着内存地址增大的方向生长。

4. 碎片问题：栈内存空间连续，先入后出保证了不会有零碎空间；堆分配是每次在空闲链表中遍历到第一个大于申请空间的节点，每次分配的空间一般不会正好等于申请内存大小，因此会有产生大量空间碎片。

5. 分配效率：栈分配效率高；堆分配效率低。